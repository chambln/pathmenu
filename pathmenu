#!/usr/bin/env rc

fn main {

    fn iter {
        for (i in $*) @ {
            if (test -d $i && !~ $i . && cd $i) {
                $0 `` $nl { ls | dmenu -p `pwd}
            } else realpath $i
        }
    }

    ~ $DMENU () || fn dmenu { $DMENU $* }
    ~ $LS    () || fn ls    { $LS    $* }

    if (~ $* ()) {
        iter ./
    } else {
        for (i in $*) {
            if (~ $i .) {
                iter ./
            } else iter $^i
        }
    }

}

main $*
