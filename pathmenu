#!/usr/bin/env rc

fn main {

    fn iter {
        for (i in $*) @ {
            if (test -d $i && !~ $i .) {
                cd $i
                $0 `` $nl { ls | dmenu -p `pwd}
            } else {
                realpath $i
            }
        }
    }

    if (!~ $DMENU ())
        fn dmenu { $DMENU $* }

    if (~ $* ()) {
        iter ./
    } else {
        for (i in $*) {
            if (~ $i .) {
                iter ./
            } else iter $^i
        }
    }

}

main $*
