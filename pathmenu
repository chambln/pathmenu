#!/usr/bin/env rc

fn iter {
    for (i in $*) @ {
        if (test -d $i && !~ $i . && cd $i) {
            $0 `{ printf %s\n . .. `ls | sort | uniq | dmenu -p `pwd }
        } else realpath $i
    }
}

ifs = $nl
BASE_DIR=`pwd
fn pwd { realpath --relative-base=$BASE_DIR . }
~ $* () && iter ./ || iter $*/
